# –ö–æ–Ω—Ç–µ–∫—Å—Ç –ø—Ä–æ–µ–∫—Ç–∞ –¥–ª—è LLM

## –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ
–°–∫—Ä–∏–ø—Ç –¥–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ –±—ç–∫–∞–ø–∞ —Å—Ç–∞—Ç–µ–π —Å –ø–ª–∞—Ç—Ñ–æ—Ä–º Sponsr.ru –∏ Boosty.to.
–ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ—Ç –≤ Markdown, —Å–∫–∞—á–∏–≤–∞–µ—Ç –º–µ–¥–∏–∞, –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –∏–Ω–∫—Ä–µ–º–µ–Ω—Ç–∞–ª—å–Ω—É—é —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—é.

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

```
backup.py          ‚Üí CLI —Ç–æ—á–∫–∞ –≤—Ö–æ–¥–∞, –ø–∞—Ä—Å–∏–Ω–≥ –∞—Ä–≥—É–º–µ–Ω—Ç–æ–≤
src/
‚îú‚îÄ‚îÄ config.py      ‚Üí –∑–∞–≥—Ä—É–∑–∫–∞ YAML-–∫–æ–Ω—Ñ–∏–≥–∞, dataclasses Config/Source/Auth/HugoConfig
‚îú‚îÄ‚îÄ database.py    ‚Üí SQLite –∏–Ω–¥–µ–∫—Å, CRUD –¥–ª—è PostRecord
‚îú‚îÄ‚îÄ downloader.py  ‚Üí BaseDownloader (–∞–±—Å—Ç—Ä–∞–∫—Ç–Ω—ã–π), –æ–±—â–∞—è –ª–æ–≥–∏–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è
‚îú‚îÄ‚îÄ sponsr.py      ‚Üí SponsorDownloader, API sponsr.ru
‚îú‚îÄ‚îÄ boosty.py      ‚Üí BoostyDownloader, API boosty.to
‚îî‚îÄ‚îÄ utils.py       ‚Üí —Ç—Ä–∞–Ω—Å–ª–∏—Ç–µ—Ä–∞—Ü–∏—è, —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è assets, –ø–∞—Ä—Å–∏–Ω–≥ URL
```

## –ö–ª—é—á–µ–≤—ã–µ –∫–ª–∞—Å—Å—ã

- `BaseDownloader` ‚Äî –∞–±—Å—Ç—Ä–∞–∫—Ç–Ω—ã–π –±–∞–∑–æ–≤—ã–π –∫–ª–∞—Å—Å
  - `sync()` ‚Äî —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –∞–≤—Ç–æ—Ä–∞ (–ø–æ–ª–Ω–∞—è –∏–ª–∏ –∏–Ω–∫—Ä–µ–º–µ–Ω—Ç–∞–ª—å–Ω–∞—è)
  - `fetch_posts_list()` ‚Äî –ø–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –ø–æ—Å—Ç–æ–≤ (—Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π –∏–Ω–∫—Ä–µ–º–µ–Ω—Ç–∞–ª—å–Ω–æ–≥–æ —Ä–µ–∂–∏–º–∞)
  - `download_single()` ‚Äî –æ–¥–∏–Ω –ø–æ—Å—Ç –ø–æ ID
  - `_save_post()` ‚Äî —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –Ω–∞ –¥–∏—Å–∫ + –∑–∞–ø–∏—Å—å –≤ –ë–î
  - `_download_assets()` ‚Äî –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–µ —Å–∫–∞—á–∏–≤–∞–Ω–∏–µ –º–µ–¥–∏–∞ (ThreadPoolExecutor) —Å retry
  - `_deduplicate_filename()` ‚Äî –≥–µ–Ω–µ—Ä–∞—Ü–∏—è —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –∏–º—ë–Ω —Ñ–∞–π–ª–æ–≤ –ø—Ä–∏ –∫–æ–ª–ª–∏–∑–∏–∏

- `Post` ‚Äî dataclass —Å –ø–æ–ª—è–º–∏: post_id, title, content_html, post_date, source_url, tags, assets

- `Database` ‚Äî SQLite wrapper —Å connection pooling
  - –ò—Å–ø–æ–ª—å–∑—É–µ—Ç –æ–¥–∏–Ω connection –Ω–∞ —Å–µ—Å—Å–∏—é —Å timeout=30 –∏ WAL mode
  - –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç context manager (`with Database(...) as db:`)
  - –¢–∞–±–ª–∏—Ü–∞ `sync_state` –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è —Å—Ç–∞—Ç—É—Å–∞ –∏–Ω–∫—Ä–µ–º–µ–Ω—Ç–∞–ª—å–Ω–æ–π —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏

- `retry_request()` ‚Äî —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è retry —Å exponential backoff (3 –ø–æ–ø—ã—Ç–∫–∏, –∑–∞–¥–µ—Ä–∂–∫–∞ 1-30 —Å–µ–∫). –ü—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –¥–ª—è API-–∑–∞–ø—Ä–æ—Å–æ–≤ –∏ —Å–∫–∞—á–∏–≤–∞–Ω–∏—è —Ñ–∞–π–ª–æ–≤.

## API –ø–ª–∞—Ç—Ñ–æ—Ä–º

**Sponsr:**
- –°–ø–∏—Å–æ–∫ –ø–æ—Å—Ç–æ–≤: `GET /project/{project_id}/more-posts/?offset={n}`
- –û–¥–∏–Ω –ø–æ—Å—Ç: –ø–∞—Ä—Å–∏–Ω–≥ `__NEXT_DATA__` —Å–æ —Å—Ç—Ä–∞–Ω–∏—Ü—ã `/{author}/{post_id}/`
- project_id –∏–∑ `__NEXT_DATA__` –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ –ø—Ä–æ–µ–∫—Ç–∞
- –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è: Cookie header

**Boosty:**
- –°–ø–∏—Å–æ–∫ –ø–æ—Å—Ç–æ–≤: `GET /v1/blog/{author}/post/?limit=20&offset={token}`
- –û–¥–∏–Ω –ø–æ—Å—Ç: `GET /v1/blog/{author}/post/{uuid}`
- –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è: Cookie + Authorization: Bearer

## –ò–∑–≤–µ—Å—Ç–Ω—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏

1. URL –∫–∞—Ä—Ç–∏–Ω–æ–∫ Boosty –Ω–µ —Å–æ–¥–µ—Ä–∂–∞—Ç —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è ‚Äî –æ–ø—Ä–µ–¥–µ–ª—è–µ–º –ø–æ Content-Type
2. –ó–∞–≥–æ–ª–æ–≤–∫–∏ –º–æ–≥—É—Ç —Å–æ–¥–µ—Ä–∂–∞—Ç—å –∫–∞–≤—ã—á–∫–∏ ‚Äî —ç–∫—Ä–∞–Ω–∏—Ä—É–µ–º –¥–ª—è YAML
3. –í–Ω—É—Ç—Ä–µ–Ω–Ω–∏–µ —Å—Å—ã–ª–∫–∏ –º–µ–∂–¥—É —Å—Ç–∞—Ç—å—è–º–∏ ‚Äî —Ñ–∏–∫—Å–∏–º –ø–æ—Å–ª–µ —Å–∫–∞—á–∏–≤–∞–Ω–∏—è –≤—Å–µ—Ö –ø–æ—Å—Ç–æ–≤
4. frontmatter –Ω–µ –¥–æ–ª–∂–µ–Ω –º–æ–¥–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å—Å—è –ø—Ä–∏ —Ñ–∏–∫—Å–µ —Å—Å—ã–ª–æ–∫
5. –°–µ—Ç–µ–≤—ã–µ –∑–∞–ø—Ä–æ—Å—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç retry —Å exponential backoff (–∫—Ä–æ–º–µ 4xx –æ—à–∏–±–æ–∫)
6. –ü—Ä–∏ –∫–æ–ª–ª–∏–∑–∏–∏ –∏–º—ë–Ω —Ñ–∞–π–ª–æ–≤ –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è —Ö–µ—à URL
7. –í—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ –≤–∏–¥–µ–æ (iframe/embed) –≤ Sponsr –∏ ok_video –≤ Boosty –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É—é—Ç—Å—è –≤ markdown-—Å—Å—ã–ª–∫–∏ –≤–∏–¥–∞ `[üìπ –í–∏–¥–µ–æ](embed_url)`. Hugo render hook (`site/layouts/_default/_markup/render-link.html`) —Ä–∞—Å–ø–æ–∑–Ω–∞—ë—Ç embed URL –∏–∑–≤–µ—Å—Ç–Ω—ã—Ö –≤–∏–¥–µ–æ—Ö–æ—Å—Ç–∏–Ω–≥–æ–≤ (Rutube, YouTube, Vimeo, OK.ru, VK) –∏ —Ä–µ–Ω–¥–µ—Ä–∏—Ç `<iframe>` —Å –∞–¥–∞–ø—Ç–∏–≤–Ω—ã–º –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–º `.video-container`. –í Markdown —Ñ–∞–π–ª–∞—Ö –æ—Å—Ç–∞—ë—Ç—Å—è —á–∏—Å—Ç–∞—è —Å—Å—ã–ª–∫–∞ –±–µ–∑ HTML-–≤—Å—Ç–∞–≤–æ–∫.
8. Hugo `relativeURLs = true` + `relURL` –¥–∞—ë—Ç –ø—É—Ç–∏ –≤–∏–¥–∞ `../../../path/` ‚Äî –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –¥–ª—è —Å—É–±–¥–æ–º–µ–Ω–æ–≤, –∏—Å–ø–æ–ª—å–∑—É–µ–º `path.Base` –≤ list.html
9. Sponsr: HTML –ø—Ä–µ–¥–æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è –ø–µ—Ä–µ–¥ html2text ‚Äî —Å–ª–∏—è–Ω–∏–µ –≤–ª–æ–∂–µ–Ω–Ω—ã—Ö —Ç–µ–≥–æ–≤ (`<em><em>` ‚Üí `<em>`), —Å–ª–∏—è–Ω–∏–µ —Å–æ—Å–µ–¥–Ω–∏—Ö `<em>`/`<i>` —Ç–µ–≥–æ–≤ –≤ –æ–¥–Ω–æ–º —Ä–æ–¥–∏—Ç–µ–ª–µ. –í–∞–∂–Ω–æ: –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –ø—Ä–æ–±–µ–ª–æ–≤ –≤–æ–∫—Ä—É–≥ inline-—Ç–µ–≥–æ–≤ (`<b>`, `<em>`) –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤—Å—Ç–∞–≤–∫–∞ —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ–≥–æ –º–∞—Ä–∫–µ—Ä–∞ `@@@SP@@@`, –∫–æ—Ç–æ—Ä—ã–π –∑–∞–º–µ–Ω—è–µ—Ç—Å—è –Ω–∞ –ø—Ä–æ–±–µ–ª –ø–æ—Å–ª–µ –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏ (—Ç–∞–∫ –∫–∞–∫ `html2text` —Å–∫–ª–æ–Ω–µ–Ω "—Å—ä–µ–¥–∞—Ç—å" –ø—Ä–æ–±–µ–ª—ã –Ω–∞ –≥—Ä–∞–Ω–∏—Ü–∞—Ö —Ç–µ–≥–æ–≤).
10. SQLite –∏—Å–ø–æ–ª—å–∑—É–µ—Ç timeout=30 —Å–µ–∫ –∏ WAL mode –¥–ª—è –∏–∑–±–µ–∂–∞–Ω–∏—è "database is locked" –ø—Ä–∏ –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–∞—Ö
11. `site/hugo.toml` –ø–µ—Ä–µ–∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è –ø—Ä–∏ –∫–∞–∂–¥–æ–º –∑–∞–ø—É—Å–∫–µ backup.py ‚Äî —Ä—É—á–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –Ω–µ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è
12. –î–µ–¥—É–ø–ª–∏–∫–∞—Ü–∏—è –∏–º—ë–Ω —Å–∫–∞—á–∏–≤–∞–µ–º—ã—Ö assets –¥–æ–ª–∂–Ω–∞ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç—å *–¥–æ* –∑–∞–ø–∏—Å–∏ —Ñ–∞–π–ª–∞ –∏ –±—ã—Ç—å –ø–æ—Ç–æ–∫–æ–±–µ–∑–æ–ø–∞—Å–Ω–æ–π, –∏–Ω–∞—á–µ Markdown –º–æ–∂–µ—Ç —Å—Å—ã–ª–∞—Ç—å—Å—è –Ω–∞ –Ω–µ—Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π —Ñ–∞–π–ª
13. –§–∏–∫—Å –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏—Ö —Å—Å—ã–ª–æ–∫ –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω –æ–¥–Ω–æ–π –ø–ª–∞—Ç—Ñ–æ—Ä–º–æ–π –∏ –æ–¥–Ω–∏–º –∞–≤—Ç–æ—Ä–æ–º (–Ω–µ —Ç—Ä–æ–≥–∞—Ç—å —Å—Å—ã–ª–∫–∏ –Ω–∞ –¥—Ä—É–≥–∏–µ –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã/–∞–≤—Ç–æ—Ä–æ–≤)
14. –î–ª—è —Å—É–±–¥–æ–º–µ–Ω–Ω–æ–π —Ä–∞–∑–¥–∞—á–∏ –∞–≤—Ç–æ—Ä–∞ —Å—Å—ã–ª–∫–∏ –≤ `list.html` –¥–æ–ª–∂–Ω—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `path.Base .RelPermalink` (–∏–Ω–∞—á–µ –≤–æ–∑–º–æ–∂–Ω—ã 404 –∏–∑-–∑–∞ `../../../` –ø—É—Ç–µ–π)
15. –¢–µ–≥–∏ –≤ API Sponsr –º–æ–≥—É—Ç –ø—Ä–∏—Ö–æ–¥–∏—Ç—å –∫–∞–∫ –º–∞—Å—Å–∏–≤ —Å—Ç—Ä–æ–∫ (—Å—Ç–∞—Ä—ã–π —Ñ–æ—Ä–º–∞—Ç) –∏–ª–∏ –∫–∞–∫ –º–∞—Å—Å–∏–≤ –æ–±—ä–µ–∫—Ç–æ–≤ —Å –≤–ª–æ–∂–µ–Ω–Ω–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä–æ–π `{tag: {tag_name: "..."}}`‚Äî –∏–∑–≤–ª–µ–∫–∞–µ–º —Ç–æ–ª—å–∫–æ `tag_name`
16. –ò–Ω–∫—Ä–µ–º–µ–Ω—Ç–∞–ª—å–Ω–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è: –ø–æ—Å–ª–µ –ø–µ—Ä–≤–æ–π –ø–æ–ª–Ω–æ–π –∑–∞–≥—Ä—É–∑–∫–∏ (`is_full_sync=True`) —Å–∫—Ä–∏–ø—Ç –∑–∞–≥—Ä—É–∂–∞–µ—Ç —á–∞–Ω–∫–∞–º–∏ –ø–æ 20 –ø–æ—Å—Ç–æ–≤ –∏ –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è, –∫–æ–≥–¥–∞ –≤—Å—Ç—Ä–µ—á–∞–µ—Ç N —á–∞–Ω–∫–æ–≤ –ø–æ–¥—Ä—è–¥, —Å–æ—Å—Ç–æ—è—â–∏—Ö —Ç–æ–ª—å–∫–æ –∏–∑ —É–∂–µ –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã—Ö –ø–æ—Å—Ç–æ–≤ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é N=1, —Ç.–µ. 1 –∑–∞—â–∏—Ç–Ω—ã–π —á–∞–Ω–∫). –ü–æ—Ä—è–¥–æ–∫ –ø–æ—Å—Ç–æ–≤ –≤ API: –æ—Ç –Ω–æ–≤—ã—Ö –∫ —Å—Ç–∞—Ä—ã–º (offset=0 = —Å–∞–º—ã–µ —Å–≤–µ–∂–∏–µ).
17. –ó–∞–≥–æ–ª–æ–≤–æ–∫ —Å—Ç–∞—Ç—å–∏ –≤—ã–≤–æ–¥–∏—Ç—Å—è Hugo –∏–∑ frontmatter (`title`), –ø–æ—ç—Ç–æ–º—É –∫–æ–Ω–≤–µ—Ä—Ç–µ—Ä—ã –ø–ª–∞—Ç—Ñ–æ—Ä–º –Ω–µ –¥–æ–±–∞–≤–ª—è—é—Ç `# –ó–∞–≥–æ–ª–æ–≤–æ–∫` –≤ body Markdown (–∏–Ω–∞—á–µ –ø–æ–ª—É—á–∞–µ—Ç—Å—è –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ).
18. Boosty: –ø—Ä–∏ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–∏ —Å—Ç–∏–ª–µ–π (bold/italic) –ø—Ä–æ–±–µ–ª—ã –Ω–∞ –≥—Ä–∞–Ω–∏—Ü–∞—Ö —Ñ—Ä–∞–≥–º–µ–Ω—Ç–∞ –≤—ã–Ω–æ—Å—è—Ç—Å—è –Ω–∞—Ä—É–∂—É –º–∞—Ä–∫–µ—Ä–æ–≤ (`*—Ç–µ–∫—Å—Ç *` ‚Üí `*—Ç–µ–∫—Å—Ç* `), –∏–Ω–∞—á–µ Markdown-—Ä–∞–∑–º–µ—Ç–∫–∞ –Ω–µ–≤–∞–ª–∏–¥–Ω–∞. –§—Ä–∞–≥–º–µ–Ω—Ç—ã –∏–∑ –æ–¥–Ω–∏—Ö –ø—Ä–æ–±–µ–ª–æ–≤ –Ω–µ –æ–±–æ—Ä–∞—á–∏–≤–∞—é—Ç—Å—è.
19. Boosty: API –æ—Ç–¥–∞—ë—Ç –∫–æ–Ω—Ç–µ–Ω—Ç –∫–∞–∫ –º–∞—Å—Å–∏–≤ –±–ª–æ–∫–æ–≤. `BLOCK_END` ‚Äî —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª—å –ø–∞—Ä–∞–≥—Ä–∞—Ñ–æ–≤, –≤—Å–µ inline-–±–ª–æ–∫–∏ (text, link) –º–µ–∂–¥—É –¥–≤—É–º—è `BLOCK_END` –∫–æ–Ω–∫–∞—Ç–µ–Ω–∏—Ä—É—é—Ç—Å—è –≤ –æ–¥–∏–Ω –ø–∞—Ä–∞–≥—Ä–∞—Ñ. –ü–æ–∑–∏—Ü–∏–∏ —Å—Ç–∏–ª–µ–π –≤ –±–ª–æ–∫–∞—Ö ‚Äî –≥–ª–æ–±–∞–ª—å–Ω—ã–µ (–æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ –Ω–∞—á–∞–ª–∞ –ø–∞—Ä–∞–≥—Ä–∞—Ñ–∞), –ø—Ä–∏ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–∏ –Ω–æ—Ä–º–∞–ª–∏–∑—É—é—Ç—Å—è –≤—ã—á–∏—Ç–∞–Ω–∏–µ–º offset-–∞ –ø—Ä–µ–¥—ã–¥—É—â–∏—Ö –±–ª–æ–∫–æ–≤.
20. Sponsr: –¥–ª—è –∫–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç–∏ —Ä–∞–∑–º–µ—Ç–∫–∏ –≤ `sync()` –Ω–æ–≤—ã–µ –ø–æ—Å—Ç—ã –¥–æ–≥—Ä—É–∂–∞—é—Ç—Å—è –ø–æ–ª–Ω—ã–º –∑–∞–ø—Ä–æ—Å–æ–º –ø–æ `post_id` (–∫–∞–∫ –≤ `download_single()`), —Ç–∞–∫ –∫–∞–∫ HTML –∏–∑ `/more-posts` –º–æ–∂–µ—Ç –æ—Ç–ª–∏—á–∞—Ç—å—Å—è –æ—Ç HTML —Å—Ç—Ä–∞–Ω–∏—Ü—ã –ø–æ—Å—Ç–∞.

## Docker

```
Dockerfile              ‚Üí Python 3.12-slim, –∫–æ–ø–∏—Ä—É–µ—Ç backup.py –∏ src/
docker-compose.yml      ‚Üí –≥–æ—Ç–æ–≤—ã–π –æ–±—Ä–∞–∑ –∏–∑ GHCR (–¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π)
docker-compose-dev.yml  ‚Üí —Å–±–æ—Ä–∫–∞ –∏–∑ –∏—Å—Ö–æ–¥–Ω–∏–∫–æ–≤ (build: .) –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
run-docker.sh           ‚Üí —Å–∫—Ä–∏–ø—Ç-–æ–±–µ—Ä—Ç–∫–∞ –¥–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–≥–æ –∑–∞–ø—É—Å–∫–∞ —Å —É—á–µ—Ç–æ–º config.yaml
.dockerignore           ‚Üí –∏—Å–∫–ª—é—á–∞–µ—Ç __pycache__, .git, backup/, site/public/
```

–ó–∞–ø—É—Å–∫: `./run-docker.sh` (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è). –°–∫—Ä–∏–ø—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `docker-compose.yml` (–≥–æ—Ç–æ–≤—ã–π –æ–±—Ä–∞–∑).

–†–∞–∑—Ä–∞–±–æ—Ç–∫–∞:
```bash
docker compose -f docker-compose-dev.yml build
docker compose -f docker-compose-dev.yml run --rm backup
```

–°–µ—Ä–≤–∏—Å `hugo` –ø–æ—Å–ª–µ —Å–±–æ—Ä–∫–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∫–æ–ø–∏—Ä—É–µ—Ç CSS –≤ –ø–∞–ø–∫–∏ –∞–≤—Ç–æ—Ä–æ–≤ –¥–ª—è –ø–æ–¥–¥–µ—Ä–∂–∫–∏ —Å—É–±–¥–æ–º–µ–Ω–æ–≤.

**–ü—É–±–ª–∏–∫–∞—Ü–∏—è –æ–±—Ä–∞–∑–æ–≤:**
–ù–∞—Å—Ç—Ä–æ–µ–Ω GitHub Actions workflow (`.github/workflows/docker-publish.yml`). –ü—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ —Ç–µ–≥–∞ `v*` (—Ä–µ–ª–∏–∑):
1. –°–æ–±–∏—Ä–∞–µ—Ç—Å—è –º—É–ª—å—Ç–∏–ø–ª–∞—Ç—Ñ–æ—Ä–º–µ–Ω–Ω—ã–π –æ–±—Ä–∞–∑ (amd64/arm64).
2. –ü—É–±–ª–∏–∫—É–µ—Ç—Å—è –≤ GHCR: `ghcr.io/strannick-ru/article-backup:latest` –∏ `:vX.Y.Z`.

## Hugo-—Å–∞–π—Ç

```
site/
‚îú‚îÄ‚îÄ hugo.toml           ‚Üí –∫–æ–Ω—Ñ–∏–≥ Hugo (–≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è –∏–∑ config.yaml)
‚îú‚îÄ‚îÄ build.sh            ‚Üí —Å–±–æ—Ä–∫–∞ + –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ CSS –≤ –ø–∞–ø–∫–∏ –∞–≤—Ç–æ—Ä–æ–≤
‚îú‚îÄ‚îÄ static/css/         ‚Üí —Å—Ç–∏–ª–∏ (reader.css)
‚îú‚îÄ‚îÄ layouts/_default/   ‚Üí —à–∞–±–ª–æ–Ω—ã (baseof.html, single.html, list.html, _markup/render-link.html)
‚îî‚îÄ‚îÄ public/             ‚Üí —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Å–∞–π—Ç
```

- `backup.py` –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞—ë—Ç —Å–∏–º–ª–∏–Ω–∫ `site/content ‚Üí output_dir`
- `backup.py` –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç `site/hugo.toml` –∏–∑ —Å–µ–∫—Ü–∏–∏ `hugo:` –≤ config.yaml (base_url, title, language_code)
- `build.sh` ‚Äî —Å–æ–±–∏—Ä–∞–µ—Ç Hugo –∏ –∫–æ–ø–∏—Ä—É–µ—Ç CSS –≤ –∫–∞–∂–¥—É—é –ø–∞–ø–∫—É –∞–≤—Ç–æ—Ä–∞ –¥–ª—è –∞–≤—Ç–æ–Ω–æ–º–Ω–æ–π —Ä–∞–∑–¥–∞—á–∏ —á–µ—Ä–µ–∑ —Å—É–±–¥–æ–º–µ–Ω—ã
- –û—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω—ã–µ URL –≤–∫–ª—é—á–µ–Ω—ã ‚Äî —Å–∞–π—Ç —Ä–∞–±–æ—Ç–∞–µ—Ç –∏–∑ –ª—é–±–æ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏
- RSS –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è –¥–ª—è –∞–≤—Ç–æ—Ä–∞ –∏ —Å–µ–∫—Ü–∏–∏ –ø–æ—Å—Ç–æ–≤:
  - `/{platform}/{author}/index.xml`
  - `/{platform}/{author}/posts/index.xml` ‚Äî title –±–µ—Ä—ë—Ç—Å—è –∏–∑ `author`, description ‚Äî –∏–∑ `display_name` (–∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è –≤ `posts/_index.md`)

## –°–æ–≥–ª–∞—à–µ–Ω–∏—è

- Slug –ø–∞–ø–∫–∏: `{YYYY-MM-DD}-{transliterated-title}-{short-hash}` (–¥–ª—è –æ–±—Ä–∞—Ç–Ω–æ–π —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏ —Å—Ç–∞—Ä—ã–µ –ø–æ—Å—Ç—ã –æ—Å—Ç–∞—é—Ç—Å—è –±–µ–∑ —Ö–µ—à–∞)
- Assets –≤ –ø–æ–¥–ø–∞–ø–∫–µ `assets/` —Ä—è–¥–æ–º —Å `index.md`
- –ë–µ–ª—ã–π —Å–ø–∏—Å–æ–∫ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–π: jpg, png, gif, webp, svg, mp4, webm, mov, mkv, avi, mp3, wav, flac, ogg, pdf

## –¢–∏–ø–∏—á–Ω—ã–µ –∑–∞–¥–∞—á–∏

**–î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—É—é –ø–ª–∞—Ç—Ñ–æ—Ä–º—É:**
1. –°–æ–∑–¥–∞—Ç—å `src/newplatform.py` —Å –∫–ª–∞—Å—Å–æ–º `NewPlatformDownloader(BaseDownloader)`
2. –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å: `_setup_session()`, `fetch_posts_list()`, `fetch_post()`, `_parse_post()`, `_to_markdown()`
3. –î–æ–±–∞–≤–∏—Ç—å –≤ `backup.py` –≤ `get_downloader()`
4. –î–æ–±–∞–≤–∏—Ç—å auth-–ø–æ–ª—è –≤ `config.py`

**–ò–∑–º–µ–Ω–∏—Ç—å —Ñ–æ—Ä–º–∞—Ç frontmatter:**
‚Üí `BaseDownloader._make_frontmatter()`

**–ò–∑–º–µ–Ω–∏—Ç—å —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—é assets:**
‚Üí `utils.py`: `ASSET_TYPES`, `should_download_asset()`
‚Üí `config.py`: `Source.asset_types` (image, video, audio, document)

**–ù–∞—Å—Ç—Ä–æ–∏—Ç—å retry –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:**
‚Üí `downloader.py`: `retry_request()` ‚Äî –ø–∞—Ä–∞–º–µ—Ç—Ä—ã max_retries, base_delay, max_delay, backoff_factor

**–ù–∞—Å—Ç—Ä–æ–∏—Ç—å –∏–Ω–∫—Ä–µ–º–µ–Ω—Ç–∞–ª—å–Ω—É—é —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—é:**
‚Üí `downloader.py: sync()` ‚Äî –ø–∞—Ä–∞–º–µ—Ç—Ä `safety_chunks` –≤ –≤—ã–∑–æ–≤–µ `fetch_posts_list()` (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 1)
‚Üí `sponsr.py/boosty.py: fetch_posts_list()` ‚Äî –ª–æ–≥–∏–∫–∞ –æ—Å—Ç–∞–Ω–æ–≤–∫–∏ –ø—Ä–∏ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–∏ —á–∏—Å—Ç—ã—Ö —á–∞–Ω–∫–æ–≤
‚Üí `database.py: sync_state` ‚Äî —Ç–∞–±–ª–∏—Ü–∞ —Å –ø–æ–ª—è–º–∏ platform, author, is_full_sync, last_sync_at

**–ò–∑–º–µ–Ω–∏—Ç—å —à–∞–±–ª–æ–Ω—ã Hugo:**
‚Üí `site/layouts/_default/` ‚Äî single.html (—Å—Ç–∞—Ç—å—è), list.html (—Å–ø–∏—Å–∫–∏), baseof.html (–±–∞–∑–æ–≤—ã–π)
‚Üí CSS –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–ª—è —Ç–µ–º (Light, Dark, Sepia, Gruvbox, Everforest)
‚Üí CSS –∏ –≤–Ω–µ—à–Ω–∏–µ —Ä–µ—Å—É—Ä—Å—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç `relURL` –¥–ª—è –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω—ã—Ö –ø—É—Ç–µ–π
‚Üí –°—Å—ã–ª–∫–∏ –Ω–∞ –ø–æ—Å—Ç—ã –≤ list.html –∏—Å–ø–æ–ª—å–∑—É—é—Ç `path.Base .RelPermalink` –¥–ª—è –ø—Ä—è–º—ã—Ö –ø—É—Ç–µ–π (—Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å —Å—É–±–¥–æ–º–µ–Ω–∞–º–∏)

**–î–æ–±–∞–≤–∏—Ç—å CSS –¥–ª—è –∞–≤—Ç–æ—Ä–∞:**
‚Üí –°–æ–∑–¥–∞—Ç—å `backup/{platform}/{author}/css/author.css` —Å –∫–∞—Å—Ç–æ–º–Ω—ã–º–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º–∏

**–ò–∑–º–µ–Ω–∏—Ç—å Docker-–∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é:**
‚Üí `Dockerfile` ‚Äî –±–∞–∑–æ–≤—ã–π –æ–±—Ä–∞–∑, –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏, —Ç–æ—á–∫–∞ –≤—Ö–æ–¥–∞
‚Üí `docker-compose.yml` ‚Äî volumes, —Å–µ—Ä–≤–∏—Å—ã backup –∏ hugo
‚Üí –ü–µ—Ä–µ—Å–±–æ—Ä–∫–∞: `docker compose build`

**–ò–∑–º–µ–Ω–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ Hugo:**
‚Üí `config.yaml` —Å–µ–∫—Ü–∏—è `hugo:` ‚Äî base_url, title, language_code, default_theme
‚Üí `backup.py: generate_hugo_config()` ‚Äî —à–∞–±–ª–æ–Ω –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ hugo.toml
‚Üí `src/config.py: HugoConfig` ‚Äî dataclass —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏ –∏ –∑–Ω–∞—á–µ–Ω–∏—è–º–∏ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é

## –†–µ–ª–∏–∑—ã –∏ –ø—É–±–ª–∏–∫–∞—Ü–∏—è

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø–∞–∫–µ—Ç–∞ –¥–ª—è PyPI:**
- `backup.py` ‚Äî –æ—Å–Ω–æ–≤–Ω–æ–π –º–æ–¥—É–ª—å –≤ –∫–æ—Ä–Ω–µ (py-modules)
- `src/` ‚Äî –ø–∞–∫–µ—Ç —Å –º–æ–¥—É–ª—è–º–∏ (packages.find)
- `pyproject.toml` ‚Äî –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ, –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏, entry point `article-backup`
- Entry point: `article-backup` ‚Üí `backup:main`

**–ü—Ä–æ—Ü–µ—Å—Å —Ä–µ–ª–∏–∑–∞:**

1. **–û–±–Ω–æ–≤–∏—Ç—å –≤–µ—Ä—Å–∏—é:**
   - `pyproject.toml`: `version = "X.Y.Z"`
   - `CHANGELOG.md`: –ø–µ—Ä–µ–º–µ—Å—Ç–∏—Ç—å [Unreleased] ‚Üí [X.Y.Z] —Å –¥–∞—Ç–æ–π

2. **–û–±–Ω–æ–≤–∏—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é:**
   - `README.md`: –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –∞–∫—Ç—É–∞–ª—å–Ω–æ—Å—Ç—å –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–π
   - –ë–µ–π–¥–∂–∏ PyPI, Python, License –≤ –Ω–∞—á–∞–ª–µ README

3. **–°–æ–±—Ä–∞—Ç—å –ø–∞–∫–µ—Ç:**
   ```bash
   python -m build
   python -m twine check dist/*
   ```

4. **–û–ø—É–±–ª–∏–∫–æ–≤–∞—Ç—å –Ω–∞ PyPI:**
   ```bash
   python -m twine upload dist/*
   # –¢–æ–∫–µ–Ω: pypi-...
   ```

5. **Git —Ä–µ–ª–∏–∑:**
   ```bash
   git add .
   git commit -m "–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∫ —Ä–µ–ª–∏–∑—É vX.Y.Z"
   git tag -a vX.Y.Z -m "Release vX.Y.Z"
   git push origin main
   git push origin vX.Y.Z
   ```

6. **GitHub Release:**
   - –°–æ–∑–¥–∞—Ç—å —á–µ—Ä–µ–∑ –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –∏–ª–∏ `gh release create`
   - –û–ø–∏—Å–∞–Ω–∏–µ –∏–∑ CHANGELOG
   - –ü—Ä–∏–ª–æ–∂–∏—Ç—å quickstart –∞—Ä—Ö–∏–≤:
     ```bash
     tar -czf article-backup-vX.Y.Z-quickstart.tar.gz \
       README.md LICENSE config.yaml.example \
       docker-compose.yml docker-compose-dev.yml \
       Dockerfile .dockerignore run-docker.sh \
       requirements.txt pyproject.toml \
       --transform 's,^,article-backup/,'
     gh release upload vX.Y.Z article-backup-vX.Y.Z-quickstart.tar.gz
     ```

**–ü–æ—Å–ª–µ —Ä–µ–ª–∏–∑–∞:**
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å https://pypi.org/project/article-backup/
- –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å —É—Å—Ç–∞–Ω–æ–≤–∫—É: `pip install article-backup==X.Y.Z`
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å GitHub Release —Å assets
